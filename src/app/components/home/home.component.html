<div class="home-container">
    <!-- Background Mesh Gradient -->
    <div class="mesh-background">
        <div class="mesh-blob blob-1"></div>
        <div class="mesh-blob blob-2"></div>
        <div class="mesh-blob blob-3"></div>
    </div>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <div class="hero-badge">
                <span class="pulse-dot"></span> Bảo mật được cấp năng lượng bởi AI
            </div>
            <h1 class="hero-title">
                Luôn An Toàn Trực Tuyến<br>
                <span class="text-gradient-primary">Phát Hiện Mối Đe Dọa Tức Thì</span>
            </h1>
            <p class="hero-subtitle">
                Bảo vệ AI nâng cao từ lừa đảo, câu cá và nội dung độc hại. Nhận báo cáo bảo mật tức thì trong vòng một giây.
            </p>

            <!-- Quick Action Tabs -->
            <div class="quick-action-tabs">
                <button class="tab-btn" [class.active]="activeTab === 'url'" (click)="activeTab = 'url'">
                    <i class="fas fa-link"></i> Kiểm Tra URL
                </button>
                <button class="tab-btn" [class.active]="activeTab === 'message'" (click)="activeTab = 'message'">
                    <i class="fas fa-comment-dots"></i> Kiểm tra văn bản
                </button>
                <button class="tab-btn" [class.active]="activeTab === 'file'" (click)="activeTab = 'file'">
                    <i class="fas fa-file-upload"></i> Quét Tệp
                </button>
            </div>

            <!-- URL Check Card -->
            <div class="action-card" *ngIf="activeTab === 'url'">
                <div class="action-header">
                    <i class="fas fa-link action-icon"></i>
                    <div>
                        <h3 class="action-title">Kiểm Tra Bảo Mật URL</h3>
                        <p class="action-description">Dán bất kỳ liên kết đáng ngờ nào để phân tích các mối đe dọa</p>
                    </div>
                </div>
                <div class="action-input-group">
                    <input type="text" class="action-input" placeholder="https://example.com/suspicious-link"
                        [(ngModel)]="urlInput" (keyup.enter)="startAnalysis()">
                    <button class="btn btn-primary action-btn" (click)="startAnalysis()">
                        <i class="fas fa-search"></i>
                        <span>Phân Tích Ngay</span>
                    </button>
                </div>
                <div class="action-options">
                    <label class="deep-scan-toggle">
                        <input type="checkbox" [(ngModel)]="deepScanEnabled">
                        <span class="toggle-slider"></span>
                        <span class="toggle-label"><i class="fas fa-microscope"></i> Bật Quét Sâu</span>
                    </label>
                </div>
            </div>

            <!-- Message Check Card -->
            <div class="action-card" *ngIf="activeTab === 'message'">
                <div class="action-header">
                    <i class="fas fa-comment-dots action-icon"></i>
                    <div>
                        <h3 class="action-title">Phân tích văn bản</h3>
                        <p class="action-description">Kiểm tra văn bản văn bản, email hoặc trò chuyện để tìm lừa đảo</p>
                    </div>
                </div>
                <div class="action-textarea-group">
                    <textarea class="action-textarea" placeholder="Dán tin nhắn đáng ngờ tại đây..." 
                        [(ngModel)]="messageInput" rows="4"></textarea>
                    <button class="btn btn-primary action-btn-full" (click)="analyzeMessage()">
                        <i class="fas fa-shield-alt"></i>
                        <span>Phân tích văn bản</span>
                    </button>
                </div>
            </div>

            <!-- File Scan Card -->
            <div class="action-card" *ngIf="activeTab === 'file'">
                <div class="action-header">
                    <i class="fas fa-file-upload action-icon"></i>
                    <div>
                        <h3 class="action-title">Máy Quét Tệp</h3>
                        <p class="action-description">Tải lên hình ảnh, tệp PDF hoặc HTML để phân tích</p>
                    </div>
                </div>
                <div class="action-file-group">
                    <div class="file-upload-zone" [class.has-file]="selectedFile">
                        <input type="file" id="fileInput" accept="image/*,.pdf,.txt,.html"
                            (change)="handleFileUpload($event)">
                        <label for="fileInput" class="file-upload-label">
                            <i class="fas fa-cloud-upload-alt upload-icon"></i>
                            <span class="upload-text">{{ selectedFile ? selectedFile.name : 'Nhấp hoặc kéo tệp vào đây' }}</span>
                            <span class="upload-hint">Hỗ trợ: Hình ảnh, PDF, TXT, HTML</span>
                        </label>
                    </div>
                    <button class="btn btn-primary action-btn-full" (click)="analyzeFile()">
                        <i class="fas fa-search"></i>
                        <span>Quét Tệp</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Hero Visual -->
        <div class="hero-visual">
            <div class="shield-container">
                <div class="shield-glow"></div>
                <i class="fas fa-shield-alt shield-icon"></i>
                <div class="floating-card card-1">
                    <i class="fas fa-check-circle card-icon"></i> An Toàn
                </div>
                <div class="floating-card card-2">
                    <i class="fas fa-exclamation-triangle card-icon"></i> Đe Dọa
                </div>
            </div>
        </div>
    </section>

    <!-- Analysis Info Section -->
    <section class="analysis-info-section">
        <div class="container">
            <div class="info-grid">
                <div class="info-visual">
                    <div class="radar-scan">
                        <div class="radar-line"></div>
                    </div>
                    <i class="fas fa-mobile-alt analysis-placeholder"></i>
                </div>
                <div class="info-content">
                    <h2 class="info-title">
                        Phát Hiện Mối Đe Dọa <span class="text-gradient-primary">Thời Gian Thực</span>
                    </h2>
                    <p class="info-description">
                        ShieldNet sử dụng công nghệ AI tiên tiến để phân tích tức thì các mẫu, xác minh tính xác thực và kiểm tra chéo với các cơ sở dữ liệu mối đe dọa toàn cầu. Nhận kết quả chính xác trong vòng một giây.
                    </p>
                    <div class="stats-row">
                        <div class="stat-item">
                            <span class="stat-number">99.9%</span>
                            <span class="stat-label">Tỷ Lệ Phát Hiện</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">&lt; 1s</span>
                            <span class="stat-label">Tốc Độ Phân Tích</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">24/7</span>
                            <span class="stat-label">Có Sẵn</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Bottom Features -->
    <section class="bottom-features">
        <div class="container">
            <h2 class="section-title text-center mb-5">Tại Sao Tin Tưởng ShieldNet?</h2>
            <div class="bottom-grid">
                <div class="bottom-card card">
                    <i class="fas fa-search bottom-card-icon"></i>
                    <h3 class="bottom-card-title">Phân Tích Sâu</h3>
                    <p class="bottom-card-description">Chúng tôi phân tích cấu trúc và hành vi nội dung, không chỉ danh sách đen. Phát hiện mối đe dọa chính xác hơn.</p>
                </div>
                <div class="bottom-card card">
                    <i class="fas fa-bolt bottom-card-icon"></i>
                    <h3 class="bottom-card-title">Kết Quả Tức Thì</h3>
                    <p class="bottom-card-description">Báo cáo bảo mật hoàn chỉnh trong chưa đến một giây. Không chờ đợi, không phiền phức.</p>
                </div>
                <div class="bottom-card card">
                    <i class="fas fa-shield-alt bottom-card-icon"></i>
                    <h3 class="bottom-card-title">Quyền Riêng Tư Trước Tiên</h3>
                    <p class="bottom-card-description">Dữ liệu của bạn được xử lý an toàn và không bao giờ được chia sẻ với bất kỳ ai. Quyền riêng tư của bạn quan trọng.</p>
                </div>
            </div>
        </div>
    </section>
</div>

<!-- Modern Loading Overlay -->
<div class="loading-overlay" *ngIf="isLoading">
    <div class="loading-content">
        <div class="scanner-animation">
            <div class="scanner-line"></div>
        </div>
        <div class="spinner-container">
            <div class="spinner"></div>
            <div class="spinner-core"></div>
        </div>
        <div class="loading-text-container">
            <h3 class="loading-title">Đang Phân Tích Nội Dung</h3>
            <p class="loading-stage">{{ loadingStage || 'Khởi tạo quét...' }}</p>
        </div>
        <div class="loading-progress">
            <div class="progress-bar"></div>
        </div>
    </div>
</div>

<!-- Modern Results Modal -->
<div class="modal-backdrop" *ngIf="showModal" (click)="closeModal()">
    <div class="modal-container" (click)="$event.stopPropagation()">
        <div class="modal-header">
            <div class="modal-title-wrapper">
                <h2 class="modal-title">Báo Cáo Phân Tích</h2>
                <p class="modal-subtitle" *ngIf="urlInput">{{ urlInput }}</p>
            </div>
            <button class="close-btn" (click)="closeModal()">×</button>
        </div>

        <div class="modal-body">
            <div class="result-status-card" [ngClass]="analysisResult?.status || 'unknown'">
                <div class="status-icon-wrapper">
                    <span class="status-icon-large">{{ getStatusIcon() }}</span>
                </div>
                <div class="status-info">
                    <h3 class="status-heading">{{ getStatusLabel() }}</h3>
                    <p class="status-desc">{{ analysisResult?.details }}</p>
                </div>
                <div class="score-circle">
                    <svg viewBox="0 0 36 36" class="circular-chart">
                        <path class="circle-bg"
                            d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                        <path class="circle" [attr.stroke-dasharray]="(analysisResult?.score || 0) + ', 100'"
                            d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                    </svg>
                    <div class="score-text">
                        <span class="score-value">{{ analysisResult?.score }}</span>
                        <span class="score-label">Điểm</span>
                    </div>
                </div>
            </div>

            <div class="result-details-grid" *ngIf="analysisResult">
                <div class="detail-section" *ngIf="analysisResult.threats && analysisResult.threats.length > 0">
                    <h4 class="detail-title text-danger"><i class="fas fa-exclamation-triangle"></i> Mối Đe Dọa Được Phát Hiện</h4>
                    <ul class="detail-list threat-list">
                        <li *ngFor="let threat of analysisResult.threats">{{ threat }}</li>
                    </ul>
                </div>

                <div class="detail-section"
                    *ngIf="analysisResult.recommendations && analysisResult.recommendations.length > 0">
                    <h4 class="detail-title text-success"><i class="fas fa-shield-alt"></i> Khuyến Nghị</h4>
                    <ul class="detail-list recommendation-list">
                        <li *ngFor="let rec of analysisResult.recommendations">{{ rec }}</li>
                    </ul>
                </div>

                <div class="detail-meta">
                    <span class="meta-item"><strong>ID Quét:</strong> #{{ analysisResult.timestamp | date:'mmss'
                        }}</span>
                    <span class="meta-item"><strong>Thời Gian:</strong> {{ analysisResult.timestamp | date:'medium' }}</span>
                </div>
            </div>
        </div>

        <div class="modal-footer">
            <button class="btn btn-secondary" (click)="closeModal()">Đóng Báo Cáo</button>
            <button class="btn btn-primary">Tải Xuống PDF</button>
        </div>
    </div>
</div>